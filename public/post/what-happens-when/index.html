<!DOCTYPE html>
<html lang="en-US">

<head>
<meta charset="utf-8" />
<meta name="author" content="" />
<meta name="description" content="Personal blog." />
<meta name="keywords" content="" />
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.50" />

<link rel="canonical" href="/post/what-happens-when/">
<base href="/" />
<meta property="og:title" content="What Happens When" />
<meta property="og:description" content="This is a short version of the question what happens when you enter google.com in your browser.  credit When you type &ldquo;G&rdquo;  The browser receives the event and the auto-complete functions kick in. Various suggestions will be presented to you in the dropbox below the URL bar   When you press &ldquo;Enter&rdquo;  Small amount of current to flow into the logic circuitry of the keyboard, which scans the state of each key switch, debounces the electrical noise of the rapid intermittent closure of the switch, and converts it to a keycode integer, in this case 13." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/what-happens-when/" /><meta property="article:published_time" content="2018-07-23T11:43:30&#43;05:30"/>
<meta property="article:modified_time" content="2018-07-23T11:43:30&#43;05:30"/>

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="What Happens When"/>
<meta name="twitter:description" content="This is a short version of the question what happens when you enter google.com in your browser.  credit When you type &ldquo;G&rdquo;  The browser receives the event and the auto-complete functions kick in. Various suggestions will be presented to you in the dropbox below the URL bar   When you press &ldquo;Enter&rdquo;  Small amount of current to flow into the logic circuitry of the keyboard, which scans the state of each key switch, debounces the electrical noise of the rapid intermittent closure of the switch, and converts it to a keycode integer, in this case 13."/>



<meta itemprop="name" content="What Happens When">
<meta itemprop="description" content="This is a short version of the question what happens when you enter google.com in your browser.  credit When you type &ldquo;G&rdquo;  The browser receives the event and the auto-complete functions kick in. Various suggestions will be presented to you in the dropbox below the URL bar   When you press &ldquo;Enter&rdquo;  Small amount of current to flow into the logic circuitry of the keyboard, which scans the state of each key switch, debounces the electrical noise of the rapid intermittent closure of the switch, and converts it to a keycode integer, in this case 13.">


<meta itemprop="datePublished" content="2018-07-23T11:43:30&#43;05:30" />
<meta itemprop="dateModified" content="2018-07-23T11:43:30&#43;05:30" />
<meta itemprop="wordCount" content="2469">



<meta itemprop="keywords" content="random,Interview," />


<link rel="stylesheet" href="css/layout.css" />
<style type="text/css">
body {
  background-color: #101010;
  color: #dbdbdb;
}

a { color: #dbdbdb; }

pre {
  background: #1D1F21;
  border: 1px solid #dbdbdb;
  border-radius: 5px;
}

code {
  background: #1D1F21;
}

blockquote {
  background: #1D1F21;
  border-left: 3px solid #dbdbdb;
}

table {
  margin: 1em auto;
  border-collapse: collapse;
}

table, th, td {
  border: 1px solid #dbdbdb;
}

th {
  background: #dbdbdb;
  color: #101010;
}

.siteTitle a { color: yellow; }

.post .content h1{ color: yellow; }
.post .content h2{ color: yellow; }
.post .content h3{ color: yellow; }
.post .content h4{ color: yellow; }
.post .content h5{ color: yellow; }
.post .content h6{ color: yellow; }
.post .content a:hover { color: yellow; }
.social-link:hover { color: yellow; }
.nav-item-title:hover { color: yellow; }
.tag a:hover { color: yellow; }
.copyright { color: #404040 }
.poweredby { color: #404040 }
.poweredby a { color: #404040; }
.post-preview .title a{ color: yellow; }
.content-item a:hover{
  text-decoration: underline;
  color: yellow;
}
.post-list .title { color: yellow; }
.rmore { color: yellow; }
.terms .term a:hover {
  text-decoration: underline;
  color: yellow;
}

</style>



<title>


     What Happens When 

</title>

</head>


<body>
<div class="main">
<header>

<div class="header-bar">

  <nav>
    <div class="siteTitle">
      <a href="/">Today I learned</a>
    </div> 

    
    
    <a class="nav-item active" href="/post/"><div class="nav-item-title">Posts</div></a>
    
    <a class="nav-item" href="/tags/"><div class="nav-item-title">Tags</div></a>
    
    <a class="nav-item" href="/about/"><div class="nav-item-title">About</div></a>
    

  </nav>
</div>

  
<div class="social-links-header">

  
  <a href="mailto:arju88nair@gmail.com"><div class="social-link">email</div></a>
  

  
  <a href="https://github.com/https://github.com/arju88nair" target="_blank"><div class="social-link">gh</div></a>
  

  

  
  <a href="https://twitter.com/https://github.com/arju88nair" target="_blank"><div class="social-link">twtr</div></a>
  

  

</div>


</header>


<article class="post">
    <h1 class="title"> What Happens When </h1>
    <div class="content"> 

<h2 id="this-is-a-short-version-of-the-question-what-happens-when-you-enter-google-com-in-your-browser">This is a short version of the question  what happens when you enter google.com in your browser.</h2>

<blockquote>
<h2 id="credit-https-github-com-alex-what-happens-when"><a href="https://github.com/alex/what-happens-when">credit</a></h2>

<h2 id="when-you-type-g">When you type &ldquo;G&rdquo;</h2>

<ul>
<li>The browser receives the event and the auto-complete functions kick in. Various suggestions will be presented to you in the dropbox below the URL bar</li>
</ul>
</blockquote>

<h2 id="when-you-press-enter">When you press &ldquo;Enter&rdquo;</h2>

<ul>
<li>Small amount of current to flow into the logic circuitry of the keyboard, which scans the state of each key switch, debounces the electrical noise of the rapid intermittent closure of the switch, and converts it to a keycode integer, in this case 13. Different devices handles this differently</li>
<li>When no protocol or valid domain name is given, the browser proceeds to feed the text given in the address box to the browser&rsquo;s default web search engine. In many cases the URL has a special piece of text appended to it to tell the search engine that it came from a particular browser&rsquo;s URL bar.</li>
</ul>

<h2 id="convert-non-ascii-unicode-characters-in-hostname">Convert non-ASCII Unicode characters in hostname</h2>

<ul>
<li>The browser checks the hostname for characters that are not in a-z, A-Z, 0-9, -, or ..</li>
</ul>

<h2 id="check-hsts-list">Check HSTS list</h2>

<ul>
<li>The browser checks its &ldquo;preloaded HSTS (HTTP Strict Transport Security)&rdquo; list. This is a list of websites that have requested to be contacted via HTTPS only.</li>
<li>If the website is in the list, the browser sends its request via HTTPS instead of HTTP. Otherwise, the initial request is sent via HTTP.The first HTTP request to the website by a user will receive a response requesting that the user only send HTTPS requests. However, this is  leaves the user vulnerable to a downgrade attack, which is why the HSTS list is included in modern web browsers.</li>
</ul>

<h2 id="dns-lookup">DNS lookup</h2>

<ul>
<li>Browser checks if the domain is in its cache.</li>
<li>If not found, the browser calls <code>gethostbyname</code> library function (varies by OS) to do the lookup.</li>
<li><code>gethostbyname</code> checks if the hostname can be resolved by reference in the local hosts file  before trying to resolve the hostname through DNS.</li>
<li>If it is not in the cache, it makes a request to the DNS server configured in the network stack which might be local router or the ISP&rsquo;s caching DNS server.</li>
<li>If the DNS server is on the same subnet the network library follows the ARP process below for the DNS server else the ARP process for default gateway IP.</li>
</ul>

<h2 id="arp-process-https-www-practicalnetworking-net-wp-content-uploads-2017-01-traditional-arp-process-gif"><a href="https://www.practicalnetworking.net/wp-content/uploads/2017/01/traditional-arp-process.gif">ARP process</a></h2>

<p>In order to send an ARP (Address Resolution Protocol) broadcast the network
stack library needs the target IP address to look up. It also needs to know the
MAC address of the interface it will use to send out the ARP broadcast.</p>

<p>The ARP cache is first checked for an ARP entry for our target IP. If it is in
the cache, the library function returns the result: Target IP = MAC.</p>

<p>If the entry is not in the ARP cache:</p>

<ul>
<li><p>The route table is looked up, to see if the Target IP address is on any of
the subnets on the local route table. If it is, the library uses the
interface associated with that subnet. If it is not, the library uses the
interface that has the subnet of our default gateway.</p></li>

<li><p>The MAC address of the selected network interface is looked up.</p></li>
</ul>

<p>Now that the network library has the IP address of either our DNS server or
the default gateway it can resume its DNS process:</p>

<ul>
<li>Port 53 is opened to send a UDP request to DNS server (if the response size
is too large, TCP will be used instead).</li>
<li>If the local/ISP DNS server does not have it, then a recursive search is
requested and that flows up the list of DNS servers until the SOA is reached,
and if found an answer is returned.</li>
</ul>

<h2 id="opening-of-a-socket">Opening of a socket</h2>

<hr />

<p>Once the browser receives the IP address of the destination server, it takes
   that and the given port number from the URL (the HTTP protocol defaults to port
   80, and HTTPS to port 443), and makes a call to the system library function
   named <code>socket</code> and requests a TCP socket stream - <code>AF_INET/AF_INET6</code> and
   <code>SOCK_STREAM</code>.</p>

<ul>
<li>This request is first passed to the Transport Layer where a TCP segment is
 crafted. The destination port is added to the header, and a source port is
 chosen from within the kernel&rsquo;s dynamic port range (ip_local_port_range in
 Linux).</li>
<li>This segment is sent to the Network Layer, which wraps an additional IP
 header. The IP address of the destination server as well as that of the
 current machine is inserted to form a packet.</li>

<li><p>The packet next arrives at the Link Layer. A frame header is added that
 includes the MAC address of the machine&rsquo;s NIC as well as the MAC address of
 the gateway (local router). As before, if the kernel does not know the MAC
 address of the gateway, it must broadcast an ARP query to find it.</p>

<p>At this point the packet is ready to be transmitted through different network connections</p></li>
</ul>

<h2 id="tls-handshake">TLS handshake</h2>

<ul>
<li><p>The client computer sends a <code>ClientHello</code> message to the server with its
Transport Layer Security (TLS) version, list of cipher algorithms and
compression methods available.</p></li>

<li><p>The server replies with a <code>ServerHello</code> message to the client with the
TLS version, selected cipher, selected compression methods and the server&rsquo;s
public certificate signed by a CA (Certificate Authority). The certificate
contains a public key that will be used by the client to encrypt the rest of
the handshake until a symmetric key can be agreed upon.</p></li>

<li><p>The client verifies the server digital certificate against its list of
trusted CAs. If trust can be established based on the CA, the client
generates a string of pseudo-random bytes and encrypts this with the server&rsquo;s
public key. These random bytes can be used to determine the symmetric key.</p></li>

<li><p>The server decrypts the random bytes using its private key and uses these
bytes to generate its own copy of the symmetric master key.</p></li>

<li><p>The client sends a <code>Finished</code> message to the server, encrypting a hash of
the transmission up to this point with the symmetric key.</p></li>

<li><p>The server generates its own hash, and then decrypts the client-sent hash
to verify that it matches. If it does, it sends its own <code>Finished</code> message
to the client, also encrypted with the symmetric key.</p></li>

<li><p>From now on the TLS session transmits the application (HTTP) data encrypted
with the agreed symmetric key.</p></li>
</ul>

<h2 id="http-protocol">HTTP protocol</h2>

<p>If the web browser used was written by Google, instead of sending an HTTP
request to retrieve the page, it will send a request to try and negotiate with
the server an &ldquo;upgrade&rdquo; from HTTP to the SPDY protocol.</p>

<p>If the client is using the HTTP protocol and does not support SPDY, it sends a
request to the server of the form::</p>

<pre><code>GET / HTTP/1.1
Host: google.com
Connection: close
[other headers]
</code></pre>

<p>where <code>[other headers]</code> refers to a series of colon-separated key-value pairs
formatted as per the HTTP specification and separated by single new lines.
(This assumes the web browser being used doesn&rsquo;t have any bugs violating the
HTTP spec. This also assumes that the web browser is using <code>HTTP/1.1</code>,
otherwise it may not include the <code>Host</code> header in the request and the version
specified in the <code>GET</code> request will either be <code>HTTP/1.0</code> or <code>HTTP/0.9</code>.)</p>

<p>After sending the request and headers, the web browser sends a single blank
newline to the server indicating that the content of the request is done.</p>

<p>The server responds with a response code denoting the status of the request and
responds with a response of the form::</p>

<pre><code>200 OK
[response headers]
</code></pre>

<p>Followed by a single newline, and then sends a payload of the HTML content of
<code>www.google.com</code>. The server may then either close the connection, or if
headers sent by the client requested it, keep the connection open to be reused
for further requests.</p>

<p>If the HTTP headers sent by the web browser included sufficient information for
the web server to determine if the version of the file cached by the web
browser has been unmodified since the last retrieval (ie. if the web browser
included an <code>ETag</code> header), it may instead respond with a request of
the form::</p>

<pre><code>304 Not Modified
[response headers]
</code></pre>

<p>and no payload, and the web browser instead retrieves the HTML from its cache.</p>

<p>After parsing the HTML, the web browser (and server) repeats this process
for every resource (image, CSS, favicon.ico, etc) referenced by the HTML page,
except instead of <code>GET / HTTP/1.1</code> the request will be
<code>GET /$(URL relative to www.google.com) HTTP/1.1</code>.</p>

<h2 id="http-server-request-handle">HTTP Server Request Handle</h2>

<p>The HTTPD (HTTP Daemon) server is the one handling the requests/responses on
the server side. The most common HTTPD servers are Apache or nginx for Linux
and IIS for Windows.</p>

<ul>
<li>The HTTPD (HTTP Daemon) receives the request.</li>
<li>The server breaks down the request to the following parameters:

<ul>
<li>HTTP Request Method (either <code>GET</code>, <code>HEAD</code>, <code>POST</code>, <code>PUT</code>,
<code>DELETE</code>, <code>CONNECT</code>, <code>OPTIONS</code>, or <code>TRACE</code>). In the case of a URL
entered directly into the address bar, this will be <code>GET</code>.</li>
<li>Domain, in this case - google.com.</li>
<li>Requested path/page, in this case - / (as no specific path/page was
requested, / is the default path).</li>
</ul></li>
<li>The server verifies that there is a Virtual Host configured on the server
that corresponds with google.com.</li>
<li>The server verifies that google.com can accept GET requests.</li>
<li>The server verifies that the client is allowed to use this method
(by IP, authentication, etc.).</li>
<li>If the server has a rewrite module installed (like mod_rewrite for Apache or
URL Rewrite for IIS), it tries to match the request against one of the
configured rules. If a matching rule is found, the server uses that rule to
rewrite the request.</li>
<li>The server goes to pull the content that corresponds with the request,
in our case it will fall back to the index file, as &ldquo;/&rdquo; is the main file
(some cases can override this, but this is the most common method).</li>
<li>The server parses the file according to the handler. If Google
is running on PHP, the server uses PHP to interpret the index file, and
streams the output to the client.
<br /></li>
</ul>

<h2 id="browser">Browser</h2>

<p>The location of the resource is
specified by the user using a URI (Uniform Resource Identifier).</p>

<p>The way the browser interprets and displays HTML files is specified
in the HTML and CSS specifications. These specifications are maintained
by the W3C (World Wide Web Consortium) organization, which is the
standards organization for the web.</p>

<p>Browser user interfaces have a lot in common with each other. Among the
common user interface elements are:</p>

<p><strong>Browser High Level Structure</strong></p>

<p>The components of the browsers are:</p>

<ul>
<li><strong>User interface:</strong> The user interface includes the address bar,
back/forward button, bookmarking menu, etc. Every part of the browser
display except the window where you see the requested page.</li>
<li><strong>Browser engine:</strong> The browser engine marshals actions between the UI
and the rendering engine.</li>
<li><strong>Rendering engine:</strong> The rendering engine is responsible for displaying
requested content. For example if the requested content is HTML, the
rendering engine parses HTML and CSS, and displays the parsed content on
the screen.</li>
<li><strong>Networking:</strong> The networking handles network calls such as HTTP requests,
using different implementations for different platforms behind a
platform-independent interface.</li>
<li><strong>UI backend:</strong> The UI backend is used for drawing basic widgets like combo
boxes and windows. This backend exposes a generic interface that is not
platform specific.
Underneath it uses operating system user interface methods.</li>
<li><strong>JavaScript engine:</strong> The JavaScript engine is used to parse and
execute JavaScript code.</li>
<li><strong>Data storage:</strong> The data storage is a persistence layer. The browser may
need to save all sorts of data locally, such as cookies. Browsers also
support storage mechanisms such as localStorage, IndexedDB, WebSQL and
FileSystem.</li>
</ul>

<p><strong>The parsing algorithm</strong></p>

<p>HTML cannot be parsed using the regular top-down or bottom-up parsers.</p>

<p>The reasons are:</p>

<ul>
<li>The forgiving nature of the language.</li>
<li>The fact that browsers have traditional error tolerance to support well
known cases of invalid HTML.</li>
<li>The parsing process is reentrant. For other languages, the source doesn&rsquo;t
change during parsing, but in HTML, dynamic code (such as script elements
containing <code>document.write()</code> calls) can add extra tokens, so the parsing
process actually modifies the input.</li>
</ul>

<p>Unable to use the regular parsing techniques, the browser utilizes a custom
parser for parsing HTML. The parsing algorithm is described in
detail by the HTML5 specification.</p>

<p>The algorithm consists of two stages: tokenization and tree construction.</p>

<p><strong>Actions when the parsing is finished</strong></p>

<p>The browser begins fetching external resources linked to the page (CSS, images,
JavaScript files, etc.).</p>

<p>At this stage the browser marks the document as interactive and starts
parsing scripts that are in &ldquo;deferred&rdquo; mode: those that should be
executed after the document is parsed. The document state is
set to &ldquo;complete&rdquo; and a &ldquo;load&rdquo; event is fired.</p>

<p>Note there is never an &ldquo;Invalid Syntax&rdquo; error on an HTML page. Browsers fix
any invalid content and go on.</p>

<h2 id="page-rendering">Page Rendering</h2>

<ul>
<li>Create a &lsquo;Frame Tree&rsquo; or &lsquo;Render Tree&rsquo; by traversing the DOM nodes, and
calculating the CSS style values for each node.</li>
<li>Calculate the preferred width of each node in the &lsquo;Frame Tree&rsquo; bottom up
by summing the preferred width of the child nodes and the node&rsquo;s
horizontal margins, borders, and padding.</li>
<li>Calculate the actual width of each node top-down by allocating each node&rsquo;s
available width to its children.</li>
<li>Calculate the height of each node bottom-up by applying text wrapping and
summing the child node heights and the node&rsquo;s margins, borders, and padding.</li>
<li>Calculate the coordinates of each node using the information calculated
above.</li>
<li>More complicated steps are taken when elements are <code>floated</code>,
positioned <code>absolutely</code> or <code>relatively</code>, or other complex features
are used. See
<a href="http://dev.w3.org/csswg/css2/">http://dev.w3.org/csswg/css2/</a> and <a href="http://www.w3.org/Style/CSS/current-work">http://www.w3.org/Style/CSS/current-work</a>
for more details.</li>
<li>Create layers to describe which parts of the page can be animated as a group
without being re-rasterized. Each frame/render object is assigned to a layer.</li>
<li>Textures are allocated for each layer of the page.</li>
<li>The frame/render objects for each layer are traversed and drawing commands
are executed for their respective layer. This may be rasterized by the CPU
or drawn on the GPU directly using D2D/SkiaGL.</li>
<li>All of the above steps may reuse calculated values from the last time the
webpage was rendered, so that incremental changes require less work.</li>
<li>The page layers are sent to the compositing process where they are combined
with layers for other visible content like the browser chrome, iframes
and addon panels.</li>
<li>Final layer positions are computed and the composite commands are issued
via Direct3D/OpenGL. The GPU command buffer(s) are flushed to the GPU for
asynchronous rendering and the frame is sent to the window server.</li>
</ul>

<h2 id="gpu-rendering">GPU Rendering</h2>

<ul>
<li><p>During the rendering process the graphical computing layers can use general
purpose <code>CPU</code> or the graphical processor <code>GPU</code> as well.</p></li>

<li><p>When using <code>GPU</code> for graphical rendering computations the graphical
software layers split the task into multiple pieces, so it can take advantage
of <code>GPU</code> massive parallelism for float point calculations required for
the rendering process.</p></li>
</ul>
 </div>
    <footer class="post-footer">

  <div class="post-footer-data">
    
<div class="tags">
    
      <div class="tag">
        <a href="/tags/random">#random</a>
      </div>
    
      <div class="tag">
        <a href="/tags/interview">#Interview</a>
      </div>
    
</div>

    <div class="date"> Jul 23, 2018 </div>
  </div>

</footer>


  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "thenair" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</article>

  <footer>

  <div class="social-links-footer">

  
  <a href="mailto:arju88nair@gmail.com"><div class="social-link">Email</div></a>
  

  
  <a href="https://github.com/https://github.com/arju88nair" target="_blank"><div class="social-link">GitHub</div></a>
  

  

  
  <a href="https://twitter.com/https://github.com/arju88nair" target="_blank"><div class="social-link">Twitter</div></a>
  

  

  <div class="social-link">
  <a href="/index.xml" target="_blank">RSS</a>
  </div>

</div>


  <div class="copyright"> Copyright (c) 2018, all rights reserved. </div>

  <div class="poweredby">
    Powered by <a href="https://gohugo.io/">Hugo</a>.
  </div>

  </footer>

</div> 

</body>
</html>

